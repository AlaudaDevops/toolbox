# Example workflow for triggering Kilo PR Review from your repository
# Copy this file to .github/workflows/kilo-review.yaml in your repository

name: PR Review

on:
  pull_request:
    types: [opened, synchronize, reopened]

jobs:
  trigger-review:
    runs-on: ubuntu-latest
    # Skip review for draft PRs and bot PRs
    if: github.event.pull_request.draft != true && github.actor != 'dependabot[bot]'

    steps:
      - name: Determine PR number
        id: pr-number
        run: |
          if [ -n "${{ inputs.pr_number }}" ]; then
            echo "pr_number=${{ inputs.pr_number }}" >> $GITHUB_OUTPUT
          elif [ -n "${{ github.event.pull_request.number }}" ]; then
            echo "pr_number=${{ github.event.pull_request.number }}" >> $GITHUB_OUTPUT
          else
            echo "❌ No PR number provided... will stop"
            exit 1
          fi

      - name: Trigger Kilo PR Review
        run: |
          # Trigger the kilo-pr-review workflow in run-actions repository
          gh workflow run kilo-pr-review.yaml \
            --repo alaudadevops/run-actions \
            --field repository="${{ github.repository }}" \
            --field pr_number="${{ steps.pr-number.outputs.pr_number }}"

          echo "✅ Kilo PR Review triggered for ${{ github.repository }}#${{ steps.pr-number.outputs.pr_number }}"
        env:
          GH_TOKEN: ${{ secrets.TOKEN }}
